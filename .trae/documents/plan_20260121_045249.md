我们将把 `02-risk_cot_generate`（数据生产）和 `03-cot_inspection`（数据质检）整合成一个功能完备、界面现代化的**风控思维链（Risk CoT）全流程工作台**。

新建项目目录：`04-risk_cot_tool`

### 1. 核心架构设计 (Architecture)

采用 **Flask (后端) + Tailwind CSS & Alpine.js (前端)** 的轻量级架构。
项目将采用**模块化**设计，将业务逻辑（Services）与路由（Routes）分离。

**目录结构规划：**
```text
04-risk_cot_tool/
├── app/
│   ├── __init__.py           # Flask 应用工厂，配置初始化
│   ├── routes/               # API 路由层
│   │   ├── __init__.py
│   │   ├── data_routes.py    # 数据生成相关接口
│   │   ├── infer_routes.py   # 模型推理相关接口
│   │   └── inspect_routes.py # 质检分析相关接口
│   ├── services/             # 核心业务逻辑层
│   │   ├── __init__.py
│   │   ├── data_factory.py   # 对应 02 的 generate_mock_data.py
│   │   ├── prompt_engine.py  # 对应 02 的 prompt_generate_filling.py
│   │   ├── infer_engine.py   # 对应 02 的 cot_infer.py (支持后台任务)
│   │   └── inspector.py      # 对应 03 的 services/inspector.py
│   ├── static/
│   │   ├── css/              # 样式文件 (Tailwind)
│   │   ├── js/               # 前端交互逻辑
│   │   └── ...
│   └── templates/            # Jinja2 模板
│       ├── base.html         # 通用布局（侧边栏、顶部栏）
│       ├── generate.html     # 数据生成页面
│       ├── infer.html        # 推理执行页面
│       └── inspect.html      # 结果质检页面 (复刻并美化 03 的功能)
├── data/                     # 数据存储目录 (Input/Output)
├── .env                      # 统一环境变量配置
├── requirements.txt          # 依赖清单
└── run.py                    # 启动脚本
```

### 2. 功能模块实现 (Implementation Steps)

#### **阶段一：后端重构与服务化**
1.  **数据工厂服务 (`data_factory.py`)**:
    *   封装 `RiskDataGenerator` 类。
    *   新增接口：支持前端传入生成数量、异常比例等参数。
2.  **Prompt 引擎服务 (`prompt_engine.py`)**:
    *   封装数据清洗和模板填充逻辑。
    *   支持将 CSV 转换为 Alpaca 格式。
3.  **推理引擎服务 (`infer_engine.py`)**:
    *   改造 `cot_infer.py`，支持**后台异步执行**。
    *   实现**进度追踪**（Progress Tracking），前端可轮询当前推理进度。
    *   统一 API 调用方式，支持配置 DeepSeek API Key。
4.  **质检服务 (`inspector.py`)**:
    *   迁移 `03` 项目中的质检逻辑（规则检查 + 模型评分）。

#### **阶段二：前端 UI/UX 设计**
1.  **整体风格**: 使用 **Tailwind CSS** 构建现代化、简洁的 Dashboard 界面。
2.  **导航结构**: 左侧侧边栏导航，包含三个核心模块：
    *   📊 **数据工坊 (Data Studio)**: 配置参数 -> 一键生成模拟数据 -> 实时预览表格。
    *   🧠 **推理实验室 (Inference Lab)**: 选择数据集 -> 配置模型 -> 启动推理 -> 实时日志/进度条。
    *   🧐 **质量透视 (Inspector)**: 上传/选择文件 -> 自动分析 -> 可视化展示（Badcase 高亮、评分分布）。

#### **阶段三：集成与联调**
1.  配置统一的 `.env` 文件管理所有 API Key 和路径。
2.  确保三个模块的数据流打通：生成的 CSV -> 自动转 JSONL -> 推理出结果 -> 自动加载到质检页。

### 3. 技术亮点
*   **流式反馈**: 推理过程支持前端实时显示进度条。
*   **一站式体验**: 从造数到分析无需切换项目或命令行。
*   **代码规范**: 遵循 RESTful API 设计，逻辑解耦。

准备好后，我将开始创建项目结构并迁移代码。