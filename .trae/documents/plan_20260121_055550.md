
# 剩下的开发计划：风控CoT工具整合与完善

本计划旨在完成从旧项目到新架构的迁移，并实现一个结构清晰、前端美观的 Flask Web 应用。

## 1. 后端路由与服务整合 (Backend & API)
完善 Flask Blueprint 路由，连接已迁移的 Service 层。

- **`app/routes/generator.py` (修复与完善)**
    - 修正类引用：将 `RiskDataGenerator` 修正为 `RiskDataFactory`。
    - 确保 `mock` 数据生成接口和 `alpaca` 格式转换接口正常工作。
- **`app/routes/inference.py` (新建)**
    - 实现 `/api/inference/start`：接收配置并调用 `InferenceEngine.run`（异步）。
    - 实现 `/api/inference/stop`：调用 `InferenceEngine.stop`。
    - 实现 `/api/inference/status`：SSE (Server-Sent Events) 流式推送推理进度。
- **`app/routes/inspector.py` (新建)**
    - 实现 `/api/inspector/start`：调用 `InspectorEngine.run`（支持规则/模型质检）。
    - 实现 `/api/inspector/status`：SSE 推送质检进度。
    - 实现 `/api/inspector/report`：返回质检结果统计（得分分布、通过率）。

## 2. 前端页面开发 (Frontend UI/UX)
使用 TailwindCSS + Alpine.js 构建轻量级、响应式的现代化界面。

- **`app/templates/base.html` (布局)**
    - 包含顶部导航栏 (Generator | Inference | Inspector)。
    - 引入 Tailwind CDN 和 Alpine.js CDN。
    - 全局 Toast 通知组件。
- **`app/templates/generator.html` (数据生成)**
    - 左侧表单：设置样本数量、风险比例等参数。
    - 右侧预览：生成后的数据 Table 预览。
    - 底部操作：一键转换 Alpaca 格式。
- **`app/templates/inference.html` (推理控制)**
    - 文件选择：从 `uploads` 目录选择输入文件。
    - 配置面板：API Key、并发数、模型名称。
    - 实时控制台：显示进度条和实时日志。
- **`app/templates/inspector.html` (质检看板)**
    - 任务配置：选择文件、勾选启用的规则。
    - 仪表盘：图表展示（ECharts）得分分布、Bad Case 列表。

## 3. 项目基础设施与清理 (Infrastructure)
- **`run.py` (入口文件)**
    - 创建项目根目录下的启动脚本。
- **`app/__init__.py` (工厂模式)**
    - 注册所有 Blueprints。
    - 配置静态文件和模板路径。
- **清理旧文件**
    - 移除 `app/services/` 中未使用的旧文件（如旧版 `inspector.py`），确保只保留 `*_engine.py` 和 `*_base.py` 等新架构文件。

## 4. 验证与交付 (Verification)
- **全流程测试**：
    1. 生成 10 条模拟数据。
    2. 转换为 Alpaca 格式。
    3. 运行 DeepSeek R1 推理（Mock 或 少量真实调用）。
    4. 运行规则质检并查看报告。
